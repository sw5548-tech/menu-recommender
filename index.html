<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì˜¤ëŠ˜ì˜ ë©”ë‰´ ì¶”ì²œ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      text-align: center;
      padding-top: 80px;
    }
    button {
      margin: 8px;
      padding: 10px 18px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1 id="result">ì˜¤ëŠ˜ì˜ ë©”ë‰´ ì¶”ì²œ</h1>
<p id="count"></p>

<button onclick="recommend()">ì¶”ì²œ ë°›ê¸°</button>
<button onclick="addMenu()">ë©”ë‰´ ì¶”ê°€</button>

<script>
  /********************
   * ì„¤ì •
   ********************/
  const MENU_VERSION = 1; // ğŸ”¥ ë©”ë‰´ ìˆ˜ì • ì‹œ ìˆ«ì ì¦ê°€

  const DEFAULT_MENUS = [
    "ê¹€ì¹˜ë³¶ìŒë°¥", "ì œìœ¡ë®ë°¥", "ë¶ˆê³ ê¸°ë®ë°¥", "ë¹„ë¹”ë°¥",
    "ëœì¥ì°Œê°œ", "ê¹€ì¹˜ì°Œê°œ", "ë¼ë©´", "ì§œì¥ë©´",
    "ì§¬ë½•", "ëˆê¹ŒìŠ¤", "ì˜¤ë¯€ë¼ì´ìŠ¤", "íŒŒìŠ¤íƒ€"
    // ğŸ‘‰ ì—¬ê¸°ì— 300ê°œ ì´ìƒ ê°€ëŠ¥
  ];

  const STORAGE_KEY = "menuData";

  /********************
   * ìœ í‹¸
   ********************/
  function uniqueArray(arr) {
    return [...new Set(arr.map(v => v.trim()).filter(v => v))];
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  /********************
   * ë°ì´í„° ë¡œë“œ (ë²„ì „ ê´€ë¦¬ + ì¤‘ë³µ ì œê±°)
   ********************/
  function loadData() {
    const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));

    if (!saved || saved.version !== MENU_VERSION) {
      const cleanMenus = shuffle(uniqueArray(DEFAULT_MENUS));
      const data = {
        version: MENU_VERSION,
        menus: cleanMenus,
        index: 0
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      return data;
    }

    // ì €ì¥ëœ ë°ì´í„°ë„ ì¤‘ë³µ ì œê±° (ì•ˆì „ë§)
    saved.menus = uniqueArray(saved.menus);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(saved));
    return saved;
  }

  function saveData(data) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  }

  /********************
   * ë©”ë‰´ ì¶”ì²œ (í¸í–¥ ì œê±°)
   ********************/
  function recommend() {
    const data = loadData();

    // í•œ ë°”í€´ ë‹¤ ëŒë©´ ë‹¤ì‹œ ì…”í”Œ
    if (data.index >= data.menus.length) {
      data.menus = shuffle(data.menus);
      data.index = 0;
    }

    const choice = data.menus[data.index];
    data.index++;

    saveData(data);

    document.getElementById("result").innerText =
      "ì˜¤ëŠ˜ì˜ ë©”ë‰´ ì¶”ì²œ: " + choice;

    document.getElementById("count").innerText =
      `ì´ ë©”ë‰´ ìˆ˜: ${data.menus.length}ê°œ`;
  }

  /********************
   * ë©”ë‰´ ì¶”ê°€
   ********************/
  function addMenu() {
    const data = loadData();
    const newMenu = prompt("ì¶”ê°€í•  ë©”ë‰´ë¥¼ ì…ë ¥í•˜ì„¸ìš”");

    if (!newMenu) return;

    if (data.menus.includes(newMenu.trim())) {
      alert("ì´ë¯¸ ìˆëŠ” ë©”ë‰´.");
      return;
    }

    data.menus.push(newMenu.trim());
    data.menus = uniqueArray(data.menus);
    saveData(data);

    alert("ë©”ë‰´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!");
    document.getElementById("count").innerText =
      `ì´ ë©”ë‰´ ìˆ˜: ${data.menus.length}ê°œ`;
  }

  /********************
   * ì´ˆê¸° ì‹¤í–‰
   ********************/
  recommend();
</script>

</body>
</html>
